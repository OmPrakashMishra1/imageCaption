<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CAPTION — AI Image Captioning</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --black: #0a0a0a;
    --white: #f5f0e8;
    --cream: #ede8dc;
    --accent: #ff4d1c;
    --accent2: #ffd60a;
    --muted: #666;
    --glass: rgba(245,240,232,0.06);
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--black);
    color: var(--white);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
    cursor: crosshair;
  }

  /* Noise overlay */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 1000;
    opacity: 0.35;
  }

  /* Glowing orbs */
  .orb {
    position: fixed;
    border-radius: 50%;
    filter: blur(120px);
    pointer-events: none;
    z-index: 0;
  }
  .orb-1 {
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(255,77,28,0.15) 0%, transparent 70%);
    top: -200px; right: -200px;
    animation: drift1 12s ease-in-out infinite alternate;
  }
  .orb-2 {
    width: 500px; height: 500px;
    background: radial-gradient(circle, rgba(255,214,10,0.08) 0%, transparent 70%);
    bottom: -150px; left: -100px;
    animation: drift2 15s ease-in-out infinite alternate;
  }

  @keyframes drift1 { to { transform: translate(-80px, 60px); } }
  @keyframes drift2 { to { transform: translate(60px, -80px); } }

  /* Nav */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    padding: 24px 48px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 100;
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(245,240,232,0.06);
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    letter-spacing: 0.12em;
    color: var(--white);
    text-decoration: none;
  }
  .logo span { color: var(--accent); }

  .nav-tag {
    font-size: 11px;
    font-weight: 300;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    border: 1px solid rgba(245,240,232,0.15);
    padding: 6px 14px;
    border-radius: 20px;
  }

  /* Hero */
  header {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 0 48px 80px;
    position: relative;
    z-index: 10;
  }

  .hero-label {
    font-size: 11px;
    font-weight: 500;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: fadeUp 0.8s ease forwards;
    opacity: 0;
    animation-delay: 0.2s;
  }
  .hero-label::before {
    content: '';
    width: 32px;
    height: 1px;
    background: var(--accent);
  }

  h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(80px, 14vw, 200px);
    line-height: 0.9;
    letter-spacing: -0.01em;
    color: var(--white);
    animation: fadeUp 1s ease forwards;
    opacity: 0;
    animation-delay: 0.4s;
  }
  h1 em {
    color: var(--accent);
    font-style: normal;
    display: block;
  }

  .hero-sub {
    display: flex;
    justify-content: flex-end;
    align-items: flex-end;
    gap: 48px;
    margin-top: 40px;
    animation: fadeUp 1s ease forwards;
    opacity: 0;
    animation-delay: 0.6s;
  }
  .hero-desc {
    max-width: 360px;
    font-size: 15px;
    font-weight: 300;
    line-height: 1.7;
    color: rgba(245,240,232,0.6);
  }
  .scroll-cta {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 12px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    white-space: nowrap;
  }
  .scroll-line {
    width: 60px;
    height: 1px;
    background: var(--muted);
    animation: lineGrow 1s ease forwards;
    animation-delay: 1.2s;
    transform-origin: left;
    transform: scaleX(0);
  }
  @keyframes lineGrow { to { transform: scaleX(1); } }

  /* Main app section */
  main {
    position: relative;
    z-index: 10;
    padding: 0 48px 120px;
  }

  .section-label {
    font-size: 11px;
    font-weight: 500;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 48px;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .section-label::before {
    content: attr(data-num);
    color: var(--accent);
    font-family: 'Bebas Neue', sans-serif;
    font-size: 18px;
    letter-spacing: 0;
  }

  /* Upload zone */
  .upload-zone {
    border: 1px dashed rgba(245,240,232,0.2);
    border-radius: 4px;
    padding: 80px 40px;
    text-align: center;
    position: relative;
    cursor: pointer;
    transition: border-color 0.3s, background 0.3s;
    background: var(--glass);
    backdrop-filter: blur(8px);
    margin-bottom: 2px;
    overflow: hidden;
  }
  .upload-zone:hover, .upload-zone.dragover {
    border-color: var(--accent);
    background: rgba(255,77,28,0.04);
  }
  .upload-zone::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent 0%, rgba(255,77,28,0.03) 100%);
    pointer-events: none;
  }

  .upload-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 24px;
    border: 1px solid rgba(245,240,232,0.15);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: transform 0.3s, border-color 0.3s;
  }
  .upload-zone:hover .upload-icon {
    transform: scale(1.05);
    border-color: var(--accent);
  }
  .upload-icon svg { color: var(--accent); }

  .upload-text {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    letter-spacing: 0.1em;
    margin-bottom: 8px;
    color: var(--white);
  }
  .upload-sub {
    font-size: 13px;
    color: var(--muted);
    font-weight: 300;
    letter-spacing: 0.05em;
  }

  #file-input { display: none; }

  /* Preview */
  #preview-container {
    display: none;
    position: relative;
    border: 1px solid rgba(245,240,232,0.1);
    border-radius: 4px;
    overflow: hidden;
    background: rgba(0,0,0,0.4);
    margin-bottom: 2px;
  }
  #preview-img {
    width: 100%;
    max-height: 520px;
    object-fit: contain;
    display: block;
  }
  .preview-overlay {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    padding: 20px;
    background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%);
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
  }
  .preview-filename {
    font-size: 12px;
    color: rgba(245,240,232,0.5);
    letter-spacing: 0.1em;
  }
  .change-btn {
    font-size: 11px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--accent);
    background: none;
    border: 1px solid var(--accent);
    padding: 6px 14px;
    border-radius: 2px;
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
  }
  .change-btn:hover { background: var(--accent); color: var(--black); }

  /* Controls */
  .controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2px;
    margin-bottom: 2px;
  }

  .control-block {
    background: var(--glass);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(245,240,232,0.07);
    padding: 28px;
    border-radius: 4px;
  }
  .control-label {
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 16px;
  }
  .style-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
  .pill {
    padding: 8px 16px;
    border: 1px solid rgba(245,240,232,0.12);
    border-radius: 2px;
    font-size: 12px;
    font-weight: 400;
    letter-spacing: 0.08em;
    cursor: pointer;
    transition: all 0.2s;
    color: rgba(245,240,232,0.5);
    background: transparent;
  }
  .pill:hover {
    border-color: rgba(245,240,232,0.3);
    color: var(--white);
  }
  .pill.active {
    border-color: var(--accent);
    color: var(--accent);
    background: rgba(255,77,28,0.08);
  }

  .length-slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 2px;
    background: rgba(245,240,232,0.15);
    outline: none;
    border-radius: 0;
    cursor: pointer;
    margin-top: 8px;
  }
  .length-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    border: 2px solid var(--black);
    box-shadow: 0 0 0 1px var(--accent);
  }
  .slider-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 12px;
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--muted);
    text-transform: uppercase;
  }

  /* Generate button */
  .generate-btn {
    width: 100%;
    padding: 28px;
    background: var(--accent);
    color: var(--black);
    border: none;
    border-radius: 4px;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 22px;
    letter-spacing: 0.2em;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: transform 0.15s;
    margin-bottom: 2px;
  }
  .generate-btn:hover { transform: scaleY(0.97); }
  .generate-btn:active { transform: scaleY(0.94); }
  .generate-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 60%);
    pointer-events: none;
  }
  .generate-btn:disabled {
    background: rgba(245,240,232,0.1);
    color: var(--muted);
    cursor: not-allowed;
    transform: none;
  }

  /* Loading bar */
  .loading-bar {
    height: 2px;
    background: rgba(245,240,232,0.1);
    border-radius: 0;
    overflow: hidden;
    display: none;
    margin-bottom: 2px;
  }
  .loading-bar.active { display: block; }
  .loading-progress {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2), var(--accent));
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
    width: 0%;
    transition: width 0.3s;
  }
  @keyframes shimmer { to { background-position: -200% 0; } }

  /* Output */
  #output-section {
    display: none;
    background: var(--glass);
    border: 1px solid rgba(245,240,232,0.07);
    border-radius: 4px;
    overflow: hidden;
    animation: fadeUp 0.6s ease forwards;
  }

  .output-header {
    padding: 20px 28px;
    border-bottom: 1px solid rgba(245,240,232,0.07);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .output-header-label {
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: var(--accent);
  }
  .output-actions { display: flex; gap: 8px; }
  .action-btn {
    padding: 7px 16px;
    border: 1px solid rgba(245,240,232,0.15);
    border-radius: 2px;
    background: transparent;
    color: rgba(245,240,232,0.6);
    font-size: 11px;
    letter-spacing: 0.1em;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'DM Sans', sans-serif;
  }
  .action-btn:hover {
    border-color: var(--white);
    color: var(--white);
  }
  .action-btn.copied {
    border-color: var(--accent2);
    color: var(--accent2);
  }

  .caption-variants { padding: 0; }

  .caption-item {
    padding: 28px;
    border-bottom: 1px solid rgba(245,240,232,0.05);
    position: relative;
    transition: background 0.2s;
    cursor: pointer;
  }
  .caption-item:last-child { border-bottom: none; }
  .caption-item:hover { background: rgba(245,240,232,0.03); }
  .caption-item.selected { background: rgba(255,77,28,0.05); }
  .caption-item.selected::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 2px;
    background: var(--accent);
  }

  .caption-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 14px;
    color: var(--muted);
    letter-spacing: 0.1em;
    margin-bottom: 10px;
  }
  .caption-text {
    font-size: 16px;
    line-height: 1.65;
    color: var(--white);
    font-weight: 300;
  }
  .caption-item.selected .caption-text { color: var(--white); }

  .error-msg {
    padding: 20px 28px;
    color: var(--accent);
    font-size: 13px;
    font-weight: 300;
    font-style: italic;
  }

  /* Animations */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Divider */
  .divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(245,240,232,0.1), transparent);
    margin: 80px 0;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: var(--black); }
  ::-webkit-scrollbar-thumb { background: rgba(245,240,232,0.1); border-radius: 2px; }

  @media (max-width: 768px) {
    nav, header, main { padding-left: 24px; padding-right: 24px; }
    .controls { grid-template-columns: 1fr; }
    h1 { font-size: clamp(60px, 16vw, 100px); }
  }
</style>
</head>
<body>

<div class="orb orb-1"></div>
<div class="orb orb-2"></div>

<nav>
  <a href="#" class="logo">CAP<span>.</span>TION</a>
  <span class="nav-tag">AI Powered — v2.0</span>
</nav>

<header>
  <div class="hero-label">Image Intelligence</div>
  <h1>WORDS<em>THAT HIT.</em></h1>
  <div class="hero-sub">
    <p class="hero-desc">Drop an image. Choose your style. Get captions that don't just describe — they speak. Powered by Claude.</p>
    <div class="scroll-cta">
      <div class="scroll-line"></div>
      Scroll to generate
    </div>
  </div>
</header>

<main>
  <div class="section-label" data-num="01">Upload Image</div>

  <div class="upload-zone" id="upload-zone">
    <div class="upload-icon">
      <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"/>
      </svg>
    </div>
    <div class="upload-text">Drop your image here</div>
    <div class="upload-sub">or click to browse — JPG, PNG, WEBP, GIF</div>
    <input type="file" id="file-input" accept="image/*">
  </div>

  <div id="preview-container">
    <img id="preview-img" src="" alt="Preview">
    <div class="preview-overlay">
      <span class="preview-filename" id="preview-filename"></span>
      <button class="change-btn" id="change-btn">Change Image</button>
    </div>
  </div>

  <div class="divider"></div>

  <div class="section-label" data-num="02">Configure Style</div>

  <div class="controls">
    <div class="control-block">
      <div class="control-label">Caption Style</div>
      <div class="style-pills" id="style-pills">
        <button class="pill active" data-style="witty">Witty</button>
        <button class="pill" data-style="poetic">Poetic</button>
        <button class="pill" data-style="professional">Professional</button>
        <button class="pill" data-style="cinematic">Cinematic</button>
        <button class="pill" data-style="minimal">Minimal</button>
        <button class="pill" data-style="dramatic">Dramatic</button>
      </div>
    </div>
    <div class="control-block">
      <div class="control-label">Caption Length</div>
      <input type="range" class="length-slider" id="length-slider" min="1" max="3" value="2" step="1">
      <div class="slider-labels">
        <span>Short</span>
        <span>Medium</span>
        <span>Long</span>
      </div>
    </div>
  </div>

  <button class="generate-btn" id="generate-btn">
    GENERATE CAPTIONS
  </button>

  <div class="loading-bar" id="loading-bar">
    <div class="loading-progress" id="loading-progress"></div>
  </div>

  <div id="output-section">
    <div class="output-header">
      <span class="output-header-label">Generated Captions</span>
      <div class="output-actions">
        <button class="action-btn" id="regen-btn">Regenerate</button>
        <button class="action-btn" id="copy-btn">Copy Selected</button>
      </div>
    </div>
    <div class="caption-variants" id="caption-variants"></div>
  </div>
</main>

<script>
  // State
  let selectedFile = null;
  let selectedStyle = 'witty';
  let selectedCaption = null;
  let imageBase64 = null;

  // Upload zone
  const uploadZone = document.getElementById('upload-zone');
  const fileInput = document.getElementById('file-input');
  const previewContainer = document.getElementById('preview-container');
  const previewImg = document.getElementById('preview-img');
  const previewFilename = document.getElementById('preview-filename');
  const changeBtn = document.getElementById('change-btn');

  uploadZone.addEventListener('click', () => fileInput.click());
  changeBtn.addEventListener('click', () => fileInput.click());

  uploadZone.addEventListener('dragover', e => { e.preventDefault(); uploadZone.classList.add('dragover'); });
  uploadZone.addEventListener('dragleave', () => uploadZone.classList.remove('dragover'));
  uploadZone.addEventListener('drop', e => {
    e.preventDefault();
    uploadZone.classList.remove('dragover');
    if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
  });

  fileInput.addEventListener('change', e => { if (e.target.files[0]) handleFile(e.target.files[0]); });

  function handleFile(file) {
    selectedFile = file;
    const reader = new FileReader();
    reader.onload = e => {
      imageBase64 = e.target.result.split(',')[1];
      previewImg.src = e.target.result;
      previewFilename.textContent = file.name;
      uploadZone.style.display = 'none';
      previewContainer.style.display = 'block';
      document.getElementById('output-section').style.display = 'none';
    };
    reader.readAsDataURL(file);
  }

  // Style pills
  document.getElementById('style-pills').addEventListener('click', e => {
    if (!e.target.classList.contains('pill')) return;
    document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
    e.target.classList.add('active');
    selectedStyle = e.target.dataset.style;
  });

  // Generate
  document.getElementById('generate-btn').addEventListener('click', generateCaptions);
  document.getElementById('regen-btn').addEventListener('click', generateCaptions);

  async function generateCaptions() {
    if (!imageBase64) {
      alert('Please upload an image first.');
      return;
    }

    const length = document.getElementById('length-slider').value;
    const lengthLabel = ['short (1 sentence)', 'medium (2-3 sentences)', 'long (3-5 sentences)'][length - 1];

    const btn = document.getElementById('generate-btn');
    btn.disabled = true;
    btn.textContent = 'GENERATING…';

    const loadingBar = document.getElementById('loading-bar');
    const progress = document.getElementById('loading-progress');
    loadingBar.classList.add('active');
    progress.style.width = '0%';

    let pct = 0;
    const interval = setInterval(() => {
      pct = Math.min(pct + Math.random() * 15, 85);
      progress.style.width = pct + '%';
    }, 300);

    const output = document.getElementById('output-section');
    const variants = document.getElementById('caption-variants');
    output.style.display = 'none';
    selectedCaption = null;

    const styleGuides = {
      witty: 'clever, punchy, with a surprising twist or wordplay. Avoid clichés.',
      poetic: 'lyrical and evocative, painting with language. Use imagery and metaphor.',
      professional: 'clear, concise, suitable for business or editorial use.',
      cinematic: 'dramatic, scene-setting. Reads like a film logline or storyboard note.',
      minimal: 'stripped back to the absolute essence. One powerful idea.',
      dramatic: 'intense, emotionally charged, heightened language.'
    };

    const prompt = `You are a world-class creative copywriter. Look at this image carefully and generate exactly 3 distinct caption options.

Style: ${selectedStyle} — ${styleGuides[selectedStyle]}
Length: ${lengthLabel}

Format your response as a numbered list:
1. [caption]
2. [caption]  
3. [caption]

Each caption must feel genuinely different from the others. No hashtags. No quotation marks. Just the caption text.`;

    try {
      const resp = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          model: 'claude-sonnet-4-20250514',
          max_tokens: 1000,
          messages: [{
            role: 'user',
            content: [
              { type: 'image', source: { type: 'base64', media_type: selectedFile.type || 'image/jpeg', data: imageBase64 } },
              { type: 'text', text: prompt }
            ]
          }]
        })
      });

      clearInterval(interval);
      progress.style.width = '100%';

      const data = await resp.json();
      const text = data.content?.map(c => c.text || '').join('') || '';

      // Parse numbered list
      const captions = [];
      const matches = text.match(/^\d+\.\s+(.+)$/gm);
      if (matches) {
        matches.forEach(m => captions.push(m.replace(/^\d+\.\s+/, '').trim()));
      } else {
        // fallback: split by double newlines
        text.split(/\n\n+/).filter(l => l.trim()).forEach(l => captions.push(l.trim()));
      }

      variants.innerHTML = '';
      if (captions.length === 0) {
        variants.innerHTML = `<div class="error-msg">No captions could be parsed. Try again.</div>`;
      } else {
        captions.slice(0, 3).forEach((cap, i) => {
          const el = document.createElement('div');
          el.className = 'caption-item';
          el.innerHTML = `<div class="caption-num">OPTION 0${i+1}</div><div class="caption-text">${cap}</div>`;
          el.addEventListener('click', () => {
            document.querySelectorAll('.caption-item').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            selectedCaption = cap;
          });
          variants.appendChild(el);
        });
      }

      setTimeout(() => {
        output.style.display = 'block';
        loadingBar.classList.remove('active');
        progress.style.width = '0%';
      }, 300);

    } catch (err) {
      clearInterval(interval);
      loadingBar.classList.remove('active');
      variants.innerHTML = `<div class="error-msg">Something went wrong: ${err.message}</div>`;
      output.style.display = 'block';
    }

    btn.disabled = false;
    btn.textContent = 'GENERATE CAPTIONS';
  }

  // Copy
  document.getElementById('copy-btn').addEventListener('click', () => {
    if (!selectedCaption) {
      // copy first one
      const first = document.querySelector('.caption-text');
      if (first) selectedCaption = first.textContent;
    }
    if (!selectedCaption) return;
    navigator.clipboard.writeText(selectedCaption).then(() => {
      const btn = document.getElementById('copy-btn');
      btn.textContent = 'Copied!';
      btn.classList.add('copied');
      setTimeout(() => { btn.textContent = 'Copy Selected'; btn.classList.remove('copied'); }, 2000);
    });
  });
</script>
</body>
</html>
